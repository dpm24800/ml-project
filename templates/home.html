<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.rtl.min.css" integrity="sha384-CfCrinSRH2IR6a4e6fy2q6ioOX7O6Mtm1L9vRvFZ1trBncWmMePhzvafv7oIcWiW" crossorigin="anonymous">

    <title>Homepage – Student Performance Indicator</title>
</head>
<!-- <body class="bg-primary"> -->
<body style = "background-color:#243a50;">
    <div class="login mx-auto mt-5 bg-white p-4 rounded" style="max-width: 800px;">
        <h1 class="text-center">Student Exam Performance Indicator</h1>
        <form action="{{url_for('predict_datapoint')}}" method="post">
            <h1 class="text-center"><legend>Student Exam Performance Prediction</legend></h1> <hr>

            <!-- Gender -->
            <div class="mb-3 row align-items-center">
                <label class="col-sm-4 col-form-label fw-bold">Gender</label>
                <div class="col-sm-8">
                    <select class="form-select" name="gender" required>
                        <option value="" {% if not form_data.gender %}selected{% endif %}>Select your Gender</option>
                        <option value="male" {% if form_data.gender == 'male' %}selected{% endif %}>Male</option>
                        <option value="female" {% if form_data.gender == 'female' %}selected{% endif %}>Female</option>
                    </select>
                </div>
            </div>

            <!-- Race / Ethnicity -->
            <div class="mb-3 row align-items-center">
                <label class="col-sm-4 col-form-label fw-bold">Race or Ethnicity</label>
                <div class="col-sm-8">
                    <select class="form-select" name="ethnicity" required>
                        <option value="" {% if not form_data.ethnicity %}selected{% endif %}>Select Ethnicity</option>
                        <option value="group A" {% if form_data.ethnicity == 'group A' %}selected{% endif %}>Group A</option>
                        <option value="group B" {% if form_data.ethnicity == 'group B' %}selected{% endif %}>Group B</option>
                        <option value="group C" {% if form_data.ethnicity == 'group C' %}selected{% endif %}>Group C</option>
                        <option value="group D" {% if form_data.ethnicity == 'group D' %}selected{% endif %}>Group D</option>
                        <option value="group E" {% if form_data.ethnicity == 'group E' %}selected{% endif %}>Group E</option>
                    </select>
                </div>
            </div>

            <!-- Parental Level of Education (ESCAPED APOSTROPHES) -->
            <div class="mb-3 row align-items-center">
                <label class="col-sm-4 col-form-label fw-bold">Parental Level of Education</label>
                <div class="col-sm-8">
                    <select class="form-select" name="parental_level_of_education" required>
                        <option value="" {% if not form_data.parental_level_of_education %}selected{% endif %}>Select Parent Education</option>
                        <option value="associate's degree" {% if form_data.parental_level_of_education == "associate's degree" %}selected{% endif %}>Associate's degree</option>
                        <option value="bachelor's degree" {% if form_data.parental_level_of_education == "bachelor's degree" %}selected{% endif %}>Bachelor's degree</option>
                        <option value="high school" {% if form_data.parental_level_of_education == 'high school' %}selected{% endif %}>High school</option>
                        <option value="master's degree" {% if form_data.parental_level_of_education == "master's degree" %}selected{% endif %}>Master's degree</option>
                        <option value="some college" {% if form_data.parental_level_of_education == 'some college' %}selected{% endif %}>Some college</option>
                        <option value="some high school" {% if form_data.parental_level_of_education == 'some high school' %}selected{% endif %}>Some high school</option>
                    </select>
                </div>
            </div>

            <!-- Lunch Type -->
            <div class="mb-3 row align-items-center">
                <label class="col-sm-4 col-form-label fw-bold">Lunch Type</label>
                <div class="col-sm-8">
                    <select class="form-select" name="lunch" required>
                        <option value="" {% if not form_data.lunch %}selected{% endif %}>Select Lunch Type</option>
                        <option value="free/reduced" {% if form_data.lunch == 'free/reduced' %}selected{% endif %}>Free / Reduced</option>
                        <option value="standard" {% if form_data.lunch == 'standard' %}selected{% endif %}>Standard</option>
                    </select>
                </div>
            </div>

            <!-- Test Preparation Course -->
            <div class="mb-3 row align-items-center">
                <label class="col-sm-4 col-form-label fw-bold">Test Preparation Course</label>
                <div class="col-sm-8">
                    <select class="form-select" name="test_preparation_course" required>
                        <option value="" {% if not form_data.test_preparation_course %}selected{% endif %}>Select Test Course</option>
                        <option value="none" {% if form_data.test_preparation_course == 'none' %}selected{% endif %}>None</option>
                        <option value="completed" {% if form_data.test_preparation_course == 'completed' %}selected{% endif %}>Completed</option>
                    </select>
                </div>
            </div>

            <!-- Writing Score -->
            <div class="mb-3 row align-items-center">
                <label class="col-sm-4 col-form-label fw-bold">Writing Score (0–100)</label>
                <div class="col-sm-8">
                    <input class="form-control" 
                        type="number" 
                        name="writing_score" 
                        min="0" 
                        max="100"
                        placeholder="Enter Writing Score"
                        value="{{ form_data.writing_score }}">
                </div>
            </div>

            <!-- Reading Score -->
            <div class="mb-3 row align-items-center">
                <label class="col-sm-4 col-form-label fw-bold">Reading Score (0–100)</label>
                <div class="col-sm-8">
                    <input class="form-control" 
                        type="number" 
                        name="reading_score" 
                        min="0" 
                        max="100"
                        placeholder="Enter Reading Score"
                        value="{{ form_data.reading_score }}">
                </div>
            </div>

            <!-- Submit and Clear Buttons -->
            <div class="mb-3 text-center">
                <button type="submit" class="btn btn-primary fw-bold px-5 me-2"> Predict Your Maths Score </button>
                <button type="button" class="btn btn-outline-secondary fw-bold px-5" id="clearBtn"> Clear Form </button>
            </div>
        </form>

        <!-- Alert Section -->
        {% if error %}
        <div class="alert alert-danger text-center mt-3" role="alert">
            <strong>Error:</strong> {{ error }}
        </div>
        {% endif %}

        <!-- THE RESULT DISPLAY -->
        {% if results is not none %}
        <div class="alert alert-success text-center mt-3" role="alert">
            <h4 class="mb-0">Predicted Math Score: <strong>{{ "%.2f"|format(results) }}</strong></h4>
        </div>
        {% endif %}
    </div>

    <!-- Clear the form -->
    <script>
        document.getElementById('clearBtn').addEventListener('click', function() {
            // 1. Remove prediction result alert if exists
            const resultAlert = document.querySelector('.alert-success');
            if (resultAlert) resultAlert.remove();
            
            // Reset to initial state after short delay
            setTimeout(() => {
                // 2. Clear all select dropdowns (reset to first option)
                document.querySelectorAll('select').forEach(select => {
                    select.selectedIndex = 0;
                });
                
                // 3. Clear all number input fields
                document.querySelectorAll('input[type="number"]').forEach(input => {
                    input.value = '';
                    // Also clear any browser validation messages
                    input.setCustomValidity('');
                });
            }, 10);
            
            // 4. Optional: Focus on first field for better UX
            document.querySelector('select[name="gender"]').focus();
        });
    </script>
</body>
</html>